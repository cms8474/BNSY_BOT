## 📋 프로젝트 개요

- **서비스명**: BNSY 봇 (BNSY Bot)
- **목적**: BNK SYSTEM 관련 질의응답을 AI 챗봇으로 제공
- **기술 스택**: Java 17, Spring Boot 3.2.1, JSP, MyBatis, Oracle 21c, Ollama (Llama 3)
- **개발 일정**: 2026.01.26 ~ 2026.02.03


## 테스트 환경 아키텍처
![테스트 환경 아키텍처](https://github.com/cms8474/BNSY_BOT/blob/main/images/%ED%85%8C%EC%8A%A4%ED%8A%B8%20%ED%99%98%EA%B2%BD.png)

## 최종 솔루션 아키텍처
![최종 솔루션 아키텍처](https://github.com/cms8474/BNSY_BOT/blob/main/images/%EC%B5%9C%EC%A2%85%20%EC%86%94%EB%A3%A8%EC%85%98%20%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98.png)


## 🚀 빠른 시작 (Quick Start)

### 1. 사전 요구사항

- **JDK**: Java 17 이상
- **Maven**: 3.6 이상
- **Oracle Database**: 21c (테스트 모드에서는 localhost:1521)
- **Ollama**: Llama 3 모델 설치 필요

### 2. 데이터베이스 설정

#### (1) Oracle 접속 정보 수정
```properties
# Oracle Database Configuration
spring.datasource.url=jdbc:oracle:thin:@localhost:1521/XE
spring.datasource.username=YOUR_USERNAME
spring.datasource.password=YOUR_PASSWORD
```

> **실제 배포 시**: `*.*.*.*:1521` 로 변경

#### (2) DB 테이블 명세 (필수 테이블 생성)

아래 테이블을 생성하세요
##### 1. **회원(`MEMBERS`):** 
    CREATE TABLE MEMBERS (
        MEMBER_ID       VARCHAR2(50)    NOT NULL,       -- 아이디 (PK)
        MEMBER_PW       VARCHAR2(256)   NOT NULL,       -- 비밀번호
        MEMBER_NAME     VARCHAR2(50),                   -- 가입목적 또는 이름
        ROLE            VARCHAR2(10) DEFAULT 'USER',    -- 권한
        JOIN_DT         DATE DEFAULT SYSDATE,           -- 가입일
        CONSTRAINT PK_MEMBERS PRIMARY KEY (MEMBER_ID)
    );
##### 2. **LLM 참조 리소스 RAG(`VECTOR_STORE`):** 
    CREATE TABLE VECTOR_STORE (
      VECTOR_ID    NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      FILE_NAME    VARCHAR2(200),
      CONTENT      CLOB,           -- 문서 내용
      EMBEDDING    CLOB,           -- 벡터값
      REG_DT       DATE DEFAULT SYSDATE
    );

##### 3. **채팅내역(`CHAT_HISTORY`):** 
    CREATE TABLE CHAT_HISTORY (
        LOG_ID          NUMBER(10)      NOT NULL,       -- 로그 ID (Sequence)
        MEMBER_ID       VARCHAR2(50),                   -- 사용자 ID (FK)
        QUESTION        CLOB            NOT NULL,       -- 사용자 질문
        ANSWER          CLOB,                           -- AI 답변
        CHAT_DT         DATE DEFAULT SYSDATE,           -- 대화 일시
        CONSTRAINT PK_CHAT_HISTORY PRIMARY KEY (LOG_ID)
    );
    -- 시퀀스 생성
    CREATE SEQUENCE SEQ_CHAT_HISTORY_ID START WITH 1 INCREMENT BY 1;

##### 4. **리소스 로깅(`SERVER_METRIC`):** 
    CREATE TABLE SERVER_METRIC (
        METRIC_ID   NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY, -- 고유 ID (자동 증가)
        SERVER_IP   VARCHAR2(50) NOT NULL,                           -- 서버 IP (HA/다중 서버 구분용)
        CPU_USAGE   NUMBER(5,2) DEFAULT 0,                           -- CPU 사용률
        MEM_USAGE   NUMBER(5,2) DEFAULT 0,                           -- 메모리 사용률
        GPU_USAGE   NUMBER(5,2) DEFAULT 0,                           -- GPU 사용률 (LLM 부하 체크용)
        RPM         NUMBER DEFAULT 0,                                -- 분당 요청 수
        LATENCY     NUMBER(10,3) DEFAULT 0,                          -- 평균 응답 속도 
        STATUS      VARCHAR2(20) DEFAULT 'NORMAL',                   -- 서버 상태 
        LOG_DT      TIMESTAMP DEFAULT SYSTIMESTAMP                   -- 기록 일시
    );


### 3. 애플리케이션 실행

#### Maven을 이용한 실행

```bash
cd BNSY_BOT
mvn clean install
mvn spring-boot:run
```

#### IDE에서 실행

`src/main/java/com/bnsy/bot/BnsyBotApplication.java`

### 4. 접속 확인

브라우저에서 아래 주소로 접속:

```
http://localhost:9595
```

## 📦 프로젝트 구조

```
BNSY_BOT/
├── src/
│   ├── main/
│   │   ├── java/com/bnsy/bot/
│   │   │   ├── config/          # 설정 클래스 (MyBatis, 보안 등)
│   │   │   ├── controller/      # 컨트롤러 (MVC)
│   │   │   ├── service/          # 서비스 인터페이스
│   │   │   ├── service/impl/    # 서비스 구현체
│   │   │   ├── mapper/           # MyBatis Mapper 인터페이스
│   │   │   ├── dto/              # 데이터 전송 객체
│   │   │   ├── exception/        # 예외 처리 클래스
│   │   │   └── BnsyBotApplication.java  # 메인 클래스
│   │   ├── resources/
│   │   │   ├── mappers/          # MyBatis XML 매퍼
│   │   │   └── application.properties
│   │   └── webapp/
│   │       └── WEB-INF/views/    # JSP 파일
│   └── test/java/                # 테스트 코드
└── pom.xml
```

## ⚙️ 주요 설정

### 서버 포트

- **포트**: 9595
- 외부 접속: `*.*.*.*:9595` (포트포워딩 설정 필요)

### JSP 뷰 설정

- **JSP 경로**: `/WEB-INF/views/`
- **확장자**: `.jsp`

### MyBatis 설정

- **Mapper XML 위치**: `classpath:mappers/**/*.xml`
- **DTO 패키지**: `com.bnsy.bot.dto`

### RAG 파일 경로

- **청크 데이터**: 임의 위치 설정
- **원본 소스**: 임의 위치 설정
BNSY Team

---
